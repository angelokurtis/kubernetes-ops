receivers:
  otlp:
    protocols:
      grpc:
      http:

exporters:
  logging:
    loglevel: debug
  prometheusremotewrite:
    endpoint: http://$PROMETHEUS_PUSHGATEWAY_ENDPOINT/api/v1/write

processors:
  k8sattributes:

  transform:
    metric_statements:
      - context: datapoint
        statements:
          - set(attributes["k8s.pod.name"], resource.attributes["k8s.pod.name"]) where attributes["k8s.pod.name"] == nil

service:
  telemetry:
    metrics:
      address: ":8888"
    logs:
      level: debug
  pipelines:
    metrics:
      receivers: [ otlp ]
      processors: [ k8sattributes, transform ]
      exporters: [ logging, prometheusremotewrite ]
